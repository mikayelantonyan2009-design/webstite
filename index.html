<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Open Games</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  background: linear-gradient(135deg, #87CEEB, #ff4d4d);
  min-height: 100vh;
  position: relative;
}

/* HEADER */
header {
  width: 100%;
  background: white;
  text-align: center;
  padding: 15px 0;
  margin-bottom: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  position: relative;
}
header h1 {
  font-family: 'Orbitron', sans-serif;
  font-size: 48px;
  margin: 0;
}
header .open { color: #ff2e2e; text-shadow: 0 0 20px #ff2e2e, 0 0 40px #ff2e2e; }
header .games { color: #87CEEB; text-shadow: 0 0 20px #87CEEB, 0 0 40px #87CEEB; }

/* BACK BUTTON */
#backBtn {
  position: absolute;
  left: 15px;
  top: 15px;
  padding: 12px 25px;
  font-size: 18px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  background-color: white;
  color: #ff2e2e;
  text-shadow: 0 0 15px #ff2e2e, 0 0 30px #ff2e2e;
  transition: 0.2s;
  display: none;
}
#backBtn:hover { transform: scale(1.05); }

/* PAGE TITLE */
h2.page-title {
  font-family: 'Orbitron', sans-serif;
  color: white;
  font-size: 48px;
  margin-bottom: 20px;
}

/* BUTTONS */
.mode-selection, .xo-selection, .difficulty-selection {
  display: flex;
  gap: 40px;
  margin-bottom: 20px;
}
button {
  padding: 15px 30px;
  font-size: 20px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  background-color: white;
  transition: 0.2s;
}
button.red-glow { color: #ff2e2e; text-shadow: 0 0 15px #ff2e2e, 0 0 30px #ff2e2e; }
button.blue-glow { color: #87CEEB; text-shadow: 0 0 15px #87CEEB, 0 0 30px #87CEEB; }
button:hover { transform: scale(1.05); }

/* SCOREBOARD */
.scoreboard-box {
  display: flex;
  gap: 50px;
  margin-bottom: 15px;
  font-size: 28px;
  background-color: white;
  padding: 10px 30px;
  border-radius: 12px;
  justify-content: center;
}
.scoreboard-box div { text-shadow: 0 0 15px; }
.score-x { color: #ff2e2e; text-shadow: 0 0 20px #ff2e2e, 0 0 40px #ff2e2e; }
.score-o { color: #87CEEB; text-shadow: 0 0 20px #87CEEB, 0 0 40px #87CEEB; }

/* BOARD */
.board {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  grid-template-rows: repeat(3, 100px);
  gap: 8px;
  margin-bottom: 20px;
  position: relative;
}
.cell {
  background-color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  cursor: pointer;
  border-radius: 12px;
  transition: transform 0.1s ease, background 0.2s;
  position: relative;
  z-index: 1;
}
.cell:hover { background-color: #f0f0f0; transform: scale(1.05); }
.x { color: #ff2e2e; text-shadow: 0 0 15px #ff2e2e; }
.o { color: #87CEEB; text-shadow: 0 0 15px #87CEEB; }

#status { font-size: 22px; color: white; margin-bottom: 10px; }

/* RESTART / NEXT BUTTONS */
button.restart-btn, button.next-btn {
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  background-color: white;
  transition: 0.2s;
}
button.restart-btn.red-glow, button.next-btn.red-glow { color:#ff2e2e; text-shadow:0 0 15px #ff2e2e, 0 0 30px #ff2e2e; }
button.restart-btn.blue-glow, button.next-btn.blue-glow { color:#87CEEB; text-shadow:0 0 15px #87CEEB, 0 0 30px #87CEEB; }

/* WINNING LINE */
.line {
  position: absolute;
  height: 6px;
  border-radius: 4px;
  transform-origin: left center;
  pointer-events: none;
  z-index: 20;
}

.pulse { animation: pulse 0.5s ease-in-out; }
</style>
</head>
<body>

<header>
  <button id="backBtn" onclick="goBack()">‚Üê Back</button>
  <h1><span class="open">Open</span> <span class="games">Games</span></h1>
</header>

<h2 class="page-title">Tic Tac Toe</h2>

<!-- TIC TAC TOE MENU -->
<div class="mode-selection" id="mode-selection">
  <button class="red-glow" onclick="chooseMode('player')">Vs Player</button>
  <button class="blue-glow" onclick="chooseMode('computer')">Vs Computer</button>
</div>

<!-- XO SELECTION -->
<div class="xo-selection" id="xo-selection" style="display:none;">
  <button class="red-glow" onclick="chooseXO('X')">Play as X</button>
  <button class="blue-glow" onclick="chooseXO('O')">Play as O</button>
</div>

<!-- AI DIFFICULTY SELECTION -->
<div class="difficulty-selection" id="difficulty-selection" style="display:none;">
  <button class="red-glow" onclick="chooseDifficulty('easy')">Easy</button>
  <button class="blue-glow" onclick="chooseDifficulty('medium')">Medium</button>
  <button class="red-glow" onclick="chooseDifficulty('hard')">Hard</button>
</div>

<!-- SCOREBOARD -->
<div class="scoreboard-box" id="scoreboard" style="display:none;">
  <div class="score-x" id="scoreX">0</div>
  <div class="score-o" id="scoreO">0</div>
</div>

<div class="board" id="board" style="display:none;"></div>
<div id="status"></div>
<div>
  <button class="restart-btn red-glow" onclick="restartGame()" style="display:none;">Restart</button>
  <button class="next-btn blue-glow" onclick="nextRound()" style="display:none;">Next Round</button>
</div>

<script>
// ================= DOM =================
const boardElement = document.getElementById("board");
const scoreXDisplay = document.getElementById("scoreX");
const scoreODisplay = document.getElementById("scoreO");
const scoreboard = document.getElementById("scoreboard");
const modeSelection = document.getElementById("mode-selection");
const xoSelection = document.getElementById("xo-selection");
const difficultySelection = document.getElementById("difficulty-selection");
const backBtn = document.getElementById("backBtn");
const restartBtn = document.querySelector(".restart-btn");
const nextBtn = document.querySelector(".next-btn");

// ================= VARIABLES =================
let cells = [];
let board = ["","","","","","","","",""];
let currentPlayer = "X"; // Always X starts
let playerSymbol = "X";
let aiPlayer = "O";
let gameMode = null;
let aiDifficulty = "medium";
let gameOver = false;
let scores = { X: 0, O: 0 };
let winningLine = null;

const winningCombinations = [
  [0,1,2],[3,4,5],[6,7,8],
  [0,3,6],[1,4,7],[2,5,8],
  [0,4,8],[2,4,6]
];

// ================= CREATE BOARD =================
function createBoard(){
  boardElement.innerHTML = "";
  cells = [];

  for(let i=0;i<9;i++){
    const cell = document.createElement("div");
    cell.classList.add("cell");
    cell.dataset.index = i;

    cell.addEventListener("click", () => {
      if(board[i]!="" || gameOver) return;
      makeMove(i);
    });

    boardElement.appendChild(cell);
    cells.push(cell);
  }
}
function goBack() {
    // Hide game elements
    boardElement.style.display = "none";
    scoreboard.style.display = "none";
    xoSelection.style.display = "none";
    difficultySelection.style.display = "none";
    restartBtn.style.display = "none";
    nextBtn.style.display = "none";
    backBtn.style.display = "none";

    // Show main menu
    modeSelection.style.display = "flex";

    // Reset scores
    scores = { X: 0, O: 0 };
    updateScoreboard();

    // Clear board
    board = ["","","","","","","","",""];
    gameOver = false;

    if (winningLine) {
        winningLine.remove();
        winningLine = null;
    }
}
// ================= MENU FLOW =================
function chooseMode(mode){
  gameMode = mode === "computer" ? "ai" : "player";
  modeSelection.style.display="none";
  xoSelection.style.display="flex";
  backBtn.style.display="block";
}

function chooseXO(symbol){
  playerSymbol = symbol;
  aiPlayer = symbol==="X"?"O":"X"; // AI is opposite
  currentPlayer = "X"; // Always X starts
  xoSelection.style.display="none";

  if(gameMode==="ai"){
    difficultySelection.style.display="flex";
  } else {
    startGame();
  }
}

function chooseDifficulty(level){
  aiDifficulty = level;
  difficultySelection.style.display="none";
  startGame();
}

function startGame(){
  scoreboard.style.display="flex";
  boardElement.style.display="grid";
  restartBtn.style.display="inline-block";
  nextBtn.style.display="inline-block";

  createBoard();
  gameOver=false;
  board=["","","","","","","","",""];
  currentPlayer="X"; // Always X starts

  // If AI is X, let it start
  if(gameMode==="ai" && currentPlayer===aiPlayer){
    setTimeout(makeAIMove, 400);
  }
}

// ================= GAME LOGIC =================
function makeMove(index){
  board[index]=currentPlayer;
  cells[index].textContent=currentPlayer;
  cells[index].classList.add(currentPlayer==="X"?"x":"o");

  if(checkWinner()) return;

  if(board.every(c=>c!=="")){
    gameOver=true;
    return;
  }

  currentPlayer = currentPlayer==="X"?"O":"X";

  if(gameMode==="ai" && currentPlayer===aiPlayer && !gameOver){
    setTimeout(makeAIMove, 400);
  }
}

// ================= CHECK WIN =================
function checkWinner(){
  for(let combo of winningCombinations){
    const[a,b,c]=combo;
    if(board[a] && board[a]===board[b] && board[a]===board[c]){
      gameOver=true;
      scores[currentPlayer]++;
      updateScoreboard(currentPlayer);
      drawWinningLine(combo,currentPlayer==="X"?"red":"skyblue");
      return true;
    }
  }
  return false;
}

// ================= SCOREBOARD =================
function updateScoreboard(player){
  scoreXDisplay.textContent = scores.X;
  scoreODisplay.textContent = scores.O;

  scoreXDisplay.classList.remove("pulse");
  scoreODisplay.classList.remove("pulse");

  if(player==="X") scoreXDisplay.classList.add("pulse");
  if(player==="O") scoreODisplay.classList.add("pulse");
}

function resetScores(){
  scores={X:0,O:0};
  updateScoreboard();
}

// ================= WIN LINE =================
function drawWinningLine(combo, color) {
  if (winningLine) winningLine.remove();

  const cellSize = 100;
  const gap = 8;

  const startRow = Math.floor(combo[0] / 3);
  const startCol = combo[0] % 3;
  const endRow = Math.floor(combo[2] / 3);
  const endCol = combo[2] % 3;

  const x1 = startCol * (cellSize + gap) + cellSize / 2;
  const y1 = startRow * (cellSize + gap) + cellSize / 2;
  const x2 = endCol * (cellSize + gap) + cellSize / 2;
  const y2 = endRow * (cellSize + gap) + cellSize / 2;

  const length = Math.hypot(x2 - x1, y2 - y1);
  const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);

  const line = document.createElement("div");
  line.className = "line";
  line.style.width = length + "px";
  line.style.left = x1 + "px";
  line.style.top = y1 + "px";
  line.style.transform = `rotate(${angle}deg)`;
  line.style.background = color;
  line.style.boxShadow = `0 0 15px ${color}, 0 0 30px ${color}`;

  boardElement.appendChild(line);
  winningLine = line;
}

// ================= RESTART & NEXT =================
function restartGame(){
  resetScores();
  startGame();
}

function nextRound(){
  startGame();
}

// ================= AI =================
function makeAIMove(){
  if(gameOver) return;

  let move;

  if(aiDifficulty==="easy"){
    move=getRandomMove();
  } else {
    move=getSmartMove() ?? getRandomMove();
  }

  if(move!==undefined) makeMove(move);
}

function getRandomMove(){
  const empty=board.map((v,i)=>v===""?i:null).filter(v=>v!==null);
  if(empty.length===0) return;
  return empty[Math.floor(Math.random()*empty.length)];
}

function getSmartMove(){
  // Try to win
  for(let combo of winningCombinations){
    const vals=combo.map(i=>board[i]);
    if(vals.filter(v => v === aiPlayer).length===2 && vals.includes("")){
      return combo[vals.indexOf("")];
    }
  }

  // Block player
  const opponent = aiPlayer==="X"?"O":"X";
  for(let combo of winningCombinations){
    const vals=combo.map(i=>board[i]);
    if(vals.filter(v => v === opponent).length===2 && vals.includes("")){
      return combo[vals.indexOf("")];
    }
  }

  return null;
}
</script>
</body>
</html>
