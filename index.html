<!DOCTYPE html>
<html>
<head>
<title>Open Games - Tic Tac Toe</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    background:black;
    font-family:'Orbitron',sans-serif;
    text-align:center;
}

/* Header */
.header{
    margin-top:20px;
    font-size:48px;
}
.open{color:red;text-shadow:0 0 20px red,0 0 40px red;}
.games{color:deepskyblue;text-shadow:0 0 20px deepskyblue,0 0 40px deepskyblue;}
.subtitle{
    font-size:26px;
    color:white;
}

/* Back button */
.back{
    position:absolute;
    left:20px;
    top:20px;
    font-size:30px;
    cursor:pointer;
    display:none;
    color:red;
    text-shadow:0 0 15px red;
}

/* Menu */
.menu button{
    margin:15px;
    padding:15px 40px;
    font-size:20px;
    cursor:pointer;
    border:none;
    background:black;
    color:white;
    font-family:'Orbitron';
}
.glow-red{color:red;text-shadow:0 0 15px red;}
.glow-blue{color:deepskyblue;text-shadow:0 0 15px deepskyblue;}

/* Game board */
.board{
    width:330px;
    margin:30px auto;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    position:relative;
}
.cell{
    width:110px;
    height:110px;
    border:2px solid white;
    font-size:60px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
}
.x{color:red;text-shadow:0 0 20px red,0 0 40px red;}
.o{color:deepskyblue;text-shadow:0 0 20px deepskyblue,0 0 40px deepskyblue;}

/* Winning line */
.line{
    position:absolute;
    height:6px;
    width:330px;
    top:55px;
    left:0;
    transform-origin:left center;
    display:none;
}

/* Scoreboard */
.scoreboard{
    background:white;
    padding:10px 30px;
    display:inline-block;
    margin-top:20px;
    font-size:24px;
}
.scoreX{color:red;text-shadow:0 0 20px red;}
.scoreO{color:deepskyblue;text-shadow:0 0 20px deepskyblue;}

.controls button{
    margin:10px;
    padding:10px 25px;
    cursor:pointer;
    font-family:'Orbitron';
}
</style>
</head>
<body>

<div class="back" onclick="goBack()">←</div>

<div class="header">
<span class="open">Open</span>
<span class="games">Games</span>
<div class="subtitle">Tic Tac Toe</div>
</div>

<div id="mainMenu" class="menu">
    <button class="glow-red" onclick="selectMode('computer')">Vs Computer</button>
    <button class="glow-blue" onclick="selectMode('player')">Vs Player</button>
</div>

<div id="difficultyMenu" style="display:none">
    <h2 class="glow-red">Select Difficulty</h2>
    <button onclick="startGame('easy')">Easy</button>
    <button onclick="startGame('medium')">Medium</button>
    <button onclick="startGame('hard')">Hard</button>
</div>

<div id="gameArea" style="display:none">
    <div class="scoreboard">
        X: <span id="scoreX" class="scoreX">0</span> |
        O: <span id="scoreO" class="scoreO">0</span>
    </div>

    <div class="board" id="board">
        <div class="line" id="winLine"></div>
    </div>

    <div class="controls">
        <button onclick="nextRound()">Next Round</button>
        <button onclick="restart()">Restart</button>
    </div>
</div>

<script>
let board=[];
let currentPlayer="X";
let mode="";
let difficulty="";
let scores={X:0,O:0};
let gameActive=true;

const winCombos=[
[0,1,2],[3,4,5],[6,7,8],
[0,3,6],[1,4,7],[2,5,8],
[0,4,8],[2,4,6]
];

function selectMode(selected){
    mode=selected;
    document.getElementById("mainMenu").style.display="none";
    document.querySelector(".back").style.display="block";

    if(mode==="computer"){
        document.getElementById("difficultyMenu").style.display="block";
    }else{
        startGame();
    }
}

function startGame(diff){
    difficulty=diff||"";
    document.getElementById("difficultyMenu").style.display="none";
    document.getElementById("gameArea").style.display="block";
    initBoard();
}

function initBoard(){
    board=Array(9).fill("");
    currentPlayer="X";
    gameActive=true;
    document.getElementById("board").innerHTML='<div class="line" id="winLine"></div>';
    document.getElementById("winLine").style.display="none";

    for(let i=0;i<9;i++){
        let cell=document.createElement("div");
        cell.classList.add("cell");
        cell.dataset.index=i;
        cell.onclick=()=>handleMove(i);
        document.getElementById("board").appendChild(cell);
    }

    if(mode==="computer" && Math.random()<0.5){
        aiMove();
    }
}

function handleMove(i){
    if(!gameActive||board[i]!=="")return;
    makeMove(i,currentPlayer);

    if(checkWin()){
        scores[currentPlayer]++;
        updateScore();
        gameActive=false;
        return;
    }

    currentPlayer=currentPlayer==="X"?"O":"X";

    if(mode==="computer" && currentPlayer==="O"){
        setTimeout(aiMove,400);
    }
}

function makeMove(i,player){
    board[i]=player;
    let cell=document.querySelectorAll(".cell")[i];
    cell.textContent=player;
    cell.classList.add(player==="X"?"x":"o");
}

function aiMove(){
    if(!gameActive)return;
    let empty=board.map((v,i)=>v===""?i:null).filter(v=>v!==null);
    let move=empty[Math.floor(Math.random()*empty.length)];
    makeMove(move,"O");

    if(checkWin()){
        scores.O++;
        updateScore();
        gameActive=false;
        return;
    }

    currentPlayer="X";
}

function checkWin(){
    return winCombos.some(combo=>combo.every(i=>board[i]===currentPlayer));
}

function updateScore(){
    document.getElementById("scoreX").textContent=scores.X;
    document.getElementById("scoreO").textContent=scores.O;
}

function nextRound(){
    initBoard();
}

/* ✅ ONLY CHANGE MADE */
function restart(){
    scores={X:0,O:0};
    updateScore();
    initBoard();
}

/* ✅ ONLY CHANGE MADE */
function goBack(){
    scores={X:0,O:0};
    updateScore();

    document.getElementById("gameArea").style.display="none";
    document.getElementById("difficultyMenu").style.display="none";
    document.getElementById("mainMenu").style.display="block";
    document.querySelector(".back").style.display="none";
}
</script>

</body>
</html>
